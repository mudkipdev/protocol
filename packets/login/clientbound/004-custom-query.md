# Custom Query
| Direction   | State | ID     | Identifier               |
| ----------- | ----- | ------ | ------------------------ |
| Clientbound | Login | `0x04` | `minecraft:custom_query` |

The Custom Query packet enables servers to implement custom handshaking flows during the login process. Unlike plugin messages during gameplay, these login-phase messages follow a strict request-response pattern. This system allows servers to gather additional information or perform custom verification before allowing a client to complete the login process.

## Fields
| Field | Type | Description |
| ----- | ---- | ----------- |
| Message ID | VarInt | Generated by the server - should be unique to the connection |
| Channel | Identifier | Name of the plugin channel used to send the data |
| Data | Byte Array (1048576) | Any data, depending on the channel. The length must be inferred from the packet length |

## Usage
The vanilla Minecraft client always responds to these requests by indicating it doesn't understand them and sends an empty payload. However, modded clients can implement handlers for specific channels, enabling additional functionality during the login process. The maximum data length is strictly limited to 1048576 bytes in the vanilla client implementation.

## Common Applications
This packet system is frequently used by modded servers for:
* Mod list verification
* Custom authentication systems
* Server-specific client configuration
* Version compatibility checks
* Resource pack requirements